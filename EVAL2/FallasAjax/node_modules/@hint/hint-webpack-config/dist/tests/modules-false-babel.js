"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const path = require("path");
const mock = require("mock-require");
const utils_tests_helpers_1 = require("@hint/utils-tests-helpers");
const utils_fs_1 = require("@hint/utils-fs");
const utils_types_1 = require("@hint/utils-types");
const webpackDestPath = path.join(__dirname, 'fixtures', 'babelvalid', 'package.json');
const webpackV1DestPath = path.join(__dirname, 'fixtures', 'version1', 'package.json');
const webpackConfig = utils_fs_1.loadJSONFile(webpackDestPath);
const webpackV1Config = utils_fs_1.loadJSONFile(webpackV1DestPath);
const hintPath = utils_tests_helpers_1.getHintPath(__filename, true);
const tests = [
    {
        before() {
            const loadPackage = () => {
                return webpackConfig;
            };
            mock('@hint/utils/dist/src/packages/load-package', { loadPackage });
        },
        name: 'If babel configuration is valid and webpack version >=2 should pass',
        path: path.join(__dirname, 'fixtures', 'babelvalid')
    },
    {
        before() {
            const loadPackage = () => {
                return webpackConfig;
            };
            mock('@hint/utils/dist/src/packages/load-package', { loadPackage });
        },
        name: `If babel configuration is not valid, is should fail`,
        path: path.join(__dirname, 'fixtures', 'babelinvalid'),
        reports: [{
                message: 'Babel presets `modules` option should be `false`',
                severity: utils_types_1.Severity.error
            }]
    },
    {
        before() {
            const loadPackage = () => {
                return webpackV1Config;
            };
            mock('@hint/utils/dist/src/packages/load-package', { loadPackage });
        },
        name: 'If babel configuration is invalid, but webpack version is < 2, it should pass',
        path: path.join(__dirname, 'fixtures', 'babelinvalid')
    }
];
const generateTest = (testName) => {
    return [
        {
            before() {
                const loadPackage = () => {
                    return webpackConfig;
                };
                mock('@hint/utils/dist/src/packages/load-package', { loadPackage });
            },
            name: testName,
            path: path.join(__dirname, 'fixtures', 'babelvalid')
        }
    ];
};
utils_tests_helpers_1.testLocalHint(hintPath, tests, {
    parsers: ['webpack-config', 'babel-config'],
    serial: true
});
utils_tests_helpers_1.testLocalHint(hintPath, generateTest(`If 'webpack-config' parser is not in the configuration it should pass`), {
    parsers: [],
    serial: true
});
utils_tests_helpers_1.testLocalHint(hintPath, generateTest(`If 'babel-config' parser is not in the configuration it should pass`), {
    parsers: ['webpack-config'],
    serial: true
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kdWxlcy1mYWxzZS1iYWJlbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3Rlc3RzL21vZHVsZXMtZmFsc2UtYmFiZWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw2QkFBNkI7QUFDN0IscUNBQXFDO0FBRXJDLG1FQUFzRjtBQUN0Riw2Q0FBOEM7QUFDOUMsbURBQTZDO0FBRTdDLE1BQU0sZUFBZSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFVBQVUsRUFBRSxZQUFZLEVBQUUsY0FBYyxDQUFDLENBQUM7QUFDdkYsTUFBTSxpQkFBaUIsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxVQUFVLEVBQUUsVUFBVSxFQUFFLGNBQWMsQ0FBQyxDQUFDO0FBQ3ZGLE1BQU0sYUFBYSxHQUFHLHVCQUFZLENBQUMsZUFBZSxDQUFDLENBQUM7QUFDcEQsTUFBTSxlQUFlLEdBQUcsdUJBQVksQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO0FBQ3hELE1BQU0sUUFBUSxHQUFHLGlDQUFXLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDO0FBRS9DLE1BQU0sS0FBSyxHQUFvQjtJQUMzQjtRQUNJLE1BQU07WUFDRixNQUFNLFdBQVcsR0FBRyxHQUFHLEVBQUU7Z0JBQ3JCLE9BQU8sYUFBYSxDQUFDO1lBQ3pCLENBQUMsQ0FBQztZQUVGLElBQUksQ0FBQyw0Q0FBNEMsRUFBRSxFQUFFLFdBQVcsRUFBRSxDQUFDLENBQUM7UUFDeEUsQ0FBQztRQUNELElBQUksRUFBRSxxRUFBcUU7UUFDM0UsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFVBQVUsRUFBRSxZQUFZLENBQUM7S0FDdkQ7SUFDRDtRQUNJLE1BQU07WUFDRixNQUFNLFdBQVcsR0FBRyxHQUFHLEVBQUU7Z0JBQ3JCLE9BQU8sYUFBYSxDQUFDO1lBQ3pCLENBQUMsQ0FBQztZQUVGLElBQUksQ0FBQyw0Q0FBNEMsRUFBRSxFQUFFLFdBQVcsRUFBRSxDQUFDLENBQUM7UUFDeEUsQ0FBQztRQUNELElBQUksRUFBRSxxREFBcUQ7UUFDM0QsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFVBQVUsRUFBRSxjQUFjLENBQUM7UUFDdEQsT0FBTyxFQUFFLENBQUM7Z0JBQ04sT0FBTyxFQUFFLGtEQUFrRDtnQkFDM0QsUUFBUSxFQUFFLHNCQUFRLENBQUMsS0FBSzthQUMzQixDQUFDO0tBQ0w7SUFDRDtRQUNJLE1BQU07WUFDRixNQUFNLFdBQVcsR0FBRyxHQUFHLEVBQUU7Z0JBQ3JCLE9BQU8sZUFBZSxDQUFDO1lBQzNCLENBQUMsQ0FBQztZQUVGLElBQUksQ0FBQyw0Q0FBNEMsRUFBRSxFQUFFLFdBQVcsRUFBRSxDQUFDLENBQUM7UUFDeEUsQ0FBQztRQUNELElBQUksRUFBRSwrRUFBK0U7UUFDckYsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFVBQVUsRUFBRSxjQUFjLENBQUM7S0FDekQ7Q0FDSixDQUFDO0FBRUYsTUFBTSxZQUFZLEdBQUcsQ0FBQyxRQUFnQixFQUFtQixFQUFFO0lBQ3ZELE9BQU87UUFDSDtZQUNJLE1BQU07Z0JBQ0YsTUFBTSxXQUFXLEdBQUcsR0FBRyxFQUFFO29CQUNyQixPQUFPLGFBQWEsQ0FBQztnQkFDekIsQ0FBQyxDQUFDO2dCQUVGLElBQUksQ0FBQyw0Q0FBNEMsRUFBRSxFQUFFLFdBQVcsRUFBRSxDQUFDLENBQUM7WUFDeEUsQ0FBQztZQUNELElBQUksRUFBRSxRQUFRO1lBQ2QsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLFVBQVUsRUFBRSxZQUFZLENBQUM7U0FDdkQ7S0FDSixDQUFDO0FBQ04sQ0FBQyxDQUFDO0FBRUYsbUNBQWEsQ0FBQyxRQUFRLEVBQUUsS0FBSyxFQUFFO0lBQzNCLE9BQU8sRUFBRSxDQUFDLGdCQUFnQixFQUFFLGNBQWMsQ0FBQztJQUMzQyxNQUFNLEVBQUUsSUFBSTtDQUNmLENBQUMsQ0FBQztBQUNILG1DQUFhLENBQUMsUUFBUSxFQUFFLFlBQVksQ0FBQyx1RUFBdUUsQ0FBQyxFQUFFO0lBQzNHLE9BQU8sRUFBRSxFQUFFO0lBQ1gsTUFBTSxFQUFFLElBQUk7Q0FDZixDQUFDLENBQUM7QUFDSCxtQ0FBYSxDQUFDLFFBQVEsRUFBRSxZQUFZLENBQUMscUVBQXFFLENBQUMsRUFBRTtJQUN6RyxPQUFPLEVBQUUsQ0FBQyxnQkFBZ0IsQ0FBQztJQUMzQixNQUFNLEVBQUUsSUFBSTtDQUNmLENBQUMsQ0FBQyJ9